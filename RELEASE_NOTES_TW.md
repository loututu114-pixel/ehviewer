# EhViewer v2.0.0.5 台灣版發布說明

> **用愛發電，快樂前行** - 功能強大的Android圖片瀏覽器應用程式
> 
> 發布時間: 2025年1月15日 | 版本: 2.0.0.5 | 建置: 200005

---

## 📦 發布包資訊

### 渠道包清單

| 渠道號 | 渠道名稱 | APK檔案名稱 | 檔案大小 | MD5校驗和 | 適用場景 |
|--------|----------|-------------|----------|-----------|----------|
| **0000** | 預設版本 | `EhViewer-v2.0.0.5-channel-0000-default.apk` | 24MB | `待計算` | 直接下載使用者 |
| **3001** | 合作渠道 | `EhViewer-v2.0.0.5-channel-3001-partner.apk` | 24MB | `待計算` | 渠道推廣統計 |

### 系統需求
- **Android版本**: 6.0 (API 23) 以上
- **RAM**: 建議2GB以上
- **儲存空間**: 100MB以上可用空間
- **權限**: 儲存權限（檔案管理功能必需）

---

## 🎯 核心功能特色

### 🌐 內建瀏覽器引擎
- **雙核心支援**: 騰訊X5 WebView + 原生WebView智慧降級
- **完整瀏覽功能**: 網址列、書籤管理、歷史記錄、多分頁
- **使用者腳本系統**: 20+預設增強腳本，Tampermonkey相容
- **智慧下載**: 整合下載管理員，支援斷點續傳
- **檔案關聯**: APK安裝、多媒體播放、文件檢視

### 📊 渠道統計系統 (⭐ v2.0.0.5新增)
- **智慧重試機制**: 指數退避演算法，網路異常自動重試
- **本機快取佇列**: 離線快取失敗請求，連網後自動傳送
- **頻率控制**: 1分鐘內最多1次統計，避免重複請求
- **三大統計維度**:
  - 📱 **安裝統計**: 點擊畫廊任意按鈕時觸發
  - 🌐 **下載統計**: 瀏覽器成功存取網頁時觸發
  - 🎯 **啟動統計**: 每天軟體開啟超過10次時觸發

### 🔧 使用者腳本引擎
- **腳本庫**: 20+預設增強腳本
  - `universal_ad_blocker.js` - 通用廣告攔截
  - `baidu_app_blocker.js` - 百度應用攔截
  - `video_player_enhancer.js` - 影片播放增強
  - `bilibili_enhancer.js` - B站功能增強
  - `zhihu_enhancer.js` - 知乎體驗優化
- **自動注入**: 根據URL規則智慧載入對應腳本
- **Tampermonkey相容**: 支援標準GM_API

### 📂 檔案管理器
- **完整功能**: 檔案瀏覽、複製、移動、刪除、搜尋
- **多媒體支援**: 圖片檢視、影片播放、音訊播放
- **文件預覽**: PDF、Office文件線上檢視
- **壓縮檔支援**: 7Zip直接瀏覽和提取
- **APK安裝器**: 一鍵安裝Android應用程式
- **雲端儲存**: 支援外部儲存和網路位置

### 🎯 畫廊系統 (核心功能)
- **多源瀏覽**: 網路畫廊、本機壓縮檔、目錄瀏覽
- **智慧快取**: 圖片預載入和磁碟快取管理
- **批次下載**: 支援斷點續傳和背景下載
- **標籤系統**: 使用者標籤、分類過濾、黑名單
- **收藏同步**: 本機收藏和雲端同步

---

## 🚀 v2.0.0.5 重大改進

### 🔄 網路穩定性提升
#### 渠道統計API重試機制
- **問題解決**: 修復了原有渠道統計缺乏重試機制的問題
- **智慧重試**: 實現指數退避演算法 (1秒 → 2秒 → 4秒)，最多重試3次
- **本機快取**: 失敗請求自動快取到SharedPreferences，網路恢復後重試
- **逾時優化**: 網路逾時從5秒增加到8秒，適應弱網環境
- **網路檢測**: 使用ConnectivityManager智慧檢測網路狀態

#### 頻率控制機制
- **防重複**: 替換原有防重複驗證，使用時間間隔控制
- **頻率限制**: 每種統計類型1分鐘內最多傳送1次
- **資源友善**: 避免過度請求，減少伺服器壓力

#### 管理介面擴展
```java
// 新增管理API
channelTracker.retryPendingRequestsManually(); // 手動重試
int count = channelTracker.getPendingRequestCount(); // 查詢待傳送數量  
channelTracker.clearAllCache(); // 清理快取資料
```

### 📈 技術改進
- **程式碼品質**: 增加完善的異常處理和日誌記錄
- **記憶體優化**: 待傳送請求佇列最多50個，24小時自動過期
- **執行緒安全**: 使用Handler處理延遲重試，避免阻塞主執行緒
- **向後相容**: 保持現有API介面不變，零配置啟用

---

## 🛠️ 技術規格

### 編譯環境
- **編譯SDK**: Android 35
- **目標SDK**: Android 34
- **最小SDK**: Android 23
- **Java版本**: JDK 17
- **Gradle**: 8.x + Android Gradle Plugin

### 核心相依性
```kotlin
// 網路和解析
implementation("com.squareup.okhttp3:okhttp:3.14.7")
implementation("org.jsoup:jsoup:1.15.3")
implementation("com.alibaba:fastjson:1.2.83")

// 瀏覽器核心
implementation("com.tencent.tbs:tbssdk:44286")

// 資料庫
implementation("org.greenrobot:greendao:3.0.0")

// 分析統計
implementation("com.google.firebase:firebase-analytics:22.4.0")
implementation("com.google.firebase:firebase-crashlytics:19.4.2")
```

### 支援架構
- **ARM64**: arm64-v8a (主要)
- **ARM32**: armeabi-v7a (相容)
- **x86_64**: x86_64 (模擬器)
- **x86**: x86 (相容)

### 簽章資訊
- **簽章類型**: Release簽章
- **憑證**: debug.keystore (開發版本)
- **混淆**: 已關閉（便於除錯和回饋）

---

## 📱 安裝指南

### 渠道選擇建議
- **個人使用者**: 選擇渠道0000（預設版本）
- **推廣合作**: 選擇渠道3001（合作渠道），支援推廣效果統計
- **功能對比**: 兩個渠道功能完全相同，僅統計後台不同

### 安裝步驟
1. **下載APK**: 選擇對應渠道的APK檔案
2. **啟用權限**: 設定 → 安全性 → 允許安裝未知應用程式
3. **安裝應用程式**: 點擊APK檔案，按提示完成安裝
4. **初始化**: 首次啟動會下載騰訊X5核心（約30MB）
5. **權限授予**: 授予儲存權限以使用檔案管理功能

### ⚠️ 重要提醒
- **儲存權限**: Android 11+需要授予MANAGE_EXTERNAL_STORAGE權限
- **網路連線**: 首次使用需要連網下載瀏覽器核心
- **版本更新**: 安裝前請先卸載舊版本（如有）
- **資料備份**: 安裝前建議備份重要資料

---

## 🔧 故障排除

### 常見問題解決

#### Q: 應用程式無法安裝？
**A**: 
1. 檢查是否開啟「未知來源」權限
2. 確認Android版本不低於6.0
3. 清理安裝包下載目錄重新下載
4. 卸載舊版本後重新安裝

#### Q: 瀏覽器功能無法使用？
**A**:
1. 檢查網路連線，確保能存取網際網路
2. 等待X5核心下載完成（首次啟動需要）
3. 如果X5核心下載失敗，應用程式會自動降級到原生WebView
4. 重新啟動應用程式或清除應用程式資料

#### Q: 檔案管理功能提示權限不足？
**A**:
1. Android 11+：設定 → 應用程式 → 特殊權限 → 所有檔案存取權限
2. Android 10及以下：檢查儲存權限是否已授予
3. 部分廠商ROM需要額外設定儲存權限

#### Q: 統計功能異常？
**A**:
1. 檢查網路連線是否正常
2. 檢視應用程式日誌，搜尋「ChannelTracker」關鍵字
3. 重試機制會自動處理臨時網路問題
4. 如持續異常，可手動清除應用程式資料重置

#### Q: 效能問題或卡頓？
**A**:
1. 確保可用記憶體不少於1GB
2. 清理應用程式快取：設定 → 應用程式 → 儲存 → 清除快取
3. 重新啟動裝置釋放系統資源
4. 關閉不必要的背景應用程式

---

## 📊 資料統計說明

### 統計資料收集
為了改進產品品質和使用者體驗，應用程式會收集以下匿名統計資料：

#### 收集的資訊
- **裝置資訊**: 裝置型號、作業系統版本、螢幕解析度
- **使用統計**: 功能使用頻次、會話時長、錯誤日誌
- **渠道統計**: 安裝來源、啟動狀態（用於推廣效果分析）

#### 資料保護
- **匿名處理**: 所有資料均匿名收集，不涉及個人身份
- **本機優先**: 敏感資料優先本機處理，僅上傳必要統計
- **使用者控制**: 可在設定中關閉統計功能（Firebase Analytics）
- **安全傳輸**: 使用HTTPS加密傳輸所有資料

#### 資料用途
- **產品改進**: 分析使用者行為優化產品功能
- **錯誤修復**: 透過崩潰日誌快速定位和修復問題  
- **渠道分析**: 評估推廣效果，優化市場策略
- **效能優化**: 根據使用資料優化應用程式效能

---

## 🤝 社群與支援

### 開發團隊
- **開發者**: EhViewer台灣團隊
- **專案性質**: 開源專案
- **授權條款**: Apache License 2.0

### 獲得協助
- **使用者手冊**: 應用程式內建說明文件
- **線上支援**: 透過應用程式內回饋功能
- **社群討論**: GitHub Issues和討論區
- **更新通知**: 關注專案GitHub倉庫

### 參與貢獻
- **程式碼貢獻**: 歡迎提交Pull Request
- **問題回報**: 透過GitHub Issues回報問題
- **功能建議**: 在Discussion區域提出建議
- **翻譯協助**: 協助完善多語言支援

---

## 📋 版本歷史

### v2.0.0.5 (2025-01-15) - 目前版本
- ✅ **新增**: 渠道統計API重試機制和頻率控制
- ✅ **優化**: 網路逾時時間和異常處理
- ✅ **修復**: 相依性衝突和建置問題
- ✅ **增強**: 統計資料的可靠性和準確性

### v2.0.0.3 (歷史版本)
- 🔄 **改進**: 渠道統計API重試機制
- 📊 **優化**: 統計功能增強
- 🛡️ **提升**: 穩定性改進

### v2.0.0.1 (歷史版本)
- 🎯 **發布**: 基礎功能版本
- 🌐 **內建**: 瀏覽器引擎和使用者腳本系統
- 📂 **整合**: 檔案管理和多媒體支援
- 📊 **新增**: 基礎渠道統計功能

---

## 📞 聯絡資訊

如有任何問題或建議，請透過以下方式聯絡：

- **專案首頁**: [GitHub Repository](https://github.com/loututu114-pixel/ehviewer)
- **問題回報**: 應用程式內回饋功能
- **技術支援**: GitHub Issues
- **商務合作**: 透過專案README聯絡方式

---

*發布時間: 2025年1月15日*  
*版本: v2.0.0.5*  
*建置編號: 200005*

**EhViewer台灣團隊 © 2025 | 基於Apache License 2.0開源協議**
